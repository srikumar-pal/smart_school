<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Students - Smart School</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Main CSS -->
    <link rel="stylesheet" href="../css/style.css">
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary">
    <div class="container">
        <a class="navbar-brand fw-bold" href="../index.html">‚¨Ö Smart School</a>
        <span class="navbar-text text-white fw-bold">Student Section</span>
        <button onclick="logout()" class="btn btn-danger btn-sm ms-2">
          Logout
        </button>

    </div>
</nav>

<!-- PAGE HEADER -->
<section class="student-header">
    <div class="container text-center text-white">
        <h1 class="fw-bold">üéì Student Information</h1>
        <p>Add & manage student details easily</p>
    </div>
</section>

<!-- FORM SECTION -->
<section class="container my-5">
<form id="studentForm">

    <div class="row g-3">

        <div class="col-md-6">
            <label class="form-label">Student Name</label>
            <input type="text" id="name" class="form-control" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Class</label>
            <select id="class" class="form-select" required>
                <option value="">Select Class</option>
                <option>Class 1</option>
                <option>Class 2</option>
                <option>Class 3</option>
                <option>Class 4</option>
                <option>Class 5</option>
                <option>Class 6</option>
                <option>Class 7</option>
                <option>Class 8</option>
                <option>Class 9</option>
                <option>Class 10</option>
                <option>Class 11</option>
                <option>Class 12</option>
            </select>
        </div>

        <div class="col-md-6">
            <label class="form-label">Roll Number</label>
            <input type="number" id="roll" class="form-control" required>
        </div>

        <div class="col-md-6">
            <label class="form-label">Phone Number</label>
            <input type="tel" id="phone" class="form-control" required>
        </div>

    </div>

    <div class="text-center mt-4">
        <button type="submit" class="btn btn-success px-5 fw-bold">
            üíæ Save Student
        </button>

        <a href="students_list.html" class="btn btn-primary ms-2">
            üìã View List
        </a>
    </div>

</form>
</section>

<!-- SCRIPT -->
<script>
document.addEventListener("DOMContentLoaded", function () {

    const form = document.getElementById("studentForm");
    let students = JSON.parse(localStorage.getItem("students")) || [];
    const editIndex = localStorage.getItem("editIndex");

    // üîÅ AUTO-FILL FORM IF EDITING
    if (editIndex !== null) {
        const s = students[editIndex];
        document.getElementById("name").value = s.name;
        document.getElementById("class").value = s.className;
        document.getElementById("roll").value = s.roll;
        document.getElementById("phone").value = s.phone;
    }

    // üíæ SAVE / UPDATE
    form.addEventListener("submit", function (e) {
        e.preventDefault();

        const studentData = {
            name: document.getElementById("name").value,
            className: document.getElementById("class").value,
            roll: document.getElementById("roll").value,
            phone: document.getElementById("phone").value
        };

        if (editIndex !== null) {
            // UPDATE
            students[editIndex] = studentData;
            localStorage.removeItem("editIndex");
            alert("Student updated successfully!");
        } else {
            // ADD
            students.push(studentData);
            alert("Student added successfully!");
        }

        localStorage.setItem("students", JSON.stringify(students));
        window.location.href = "students_list.html";
    });

});
</script>
<script>
(function protectPage() {
    const role = localStorage.getItem("userRole");
    if (!role) {
        alert("Please login first!");
        window.location.href = "../login.html";
    }
})();
</script>
<script>
function logout() {
    localStorage.removeItem("userRole");
    alert("Logged out successfully");
    window.location.href = "../login.html";
}
</script>

</body>
</html>
